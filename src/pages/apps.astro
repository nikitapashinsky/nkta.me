---
import type { ImageMetadata } from 'astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import Layout from '../layouts/BaseLayout.astro';

// interface Props {
// 	imagePath: string;
// }

// const images = import.meta.glob<{ default: ImageMetadata }>(
// 	'../src/images/apps/*.{jpeg,jpg,png,gif}',
// );

// const { imagePath } = Astro.props;

// console.log(images[imagePath]);

// if (!images[imagePath])
// 	throw new Error(
// 		`"${imagePath}" does not exist in glob: "src/images/apps/*.{jpeg,jpg,png,gif}"`,
// 	);

const allApps = await getCollection('apps');
---

<Layout pageTitle="Apps I use">
	<div class="flex flex-col gap-4">
		<h1 class="text-2xl font-medium tracking-tight">Stack</h1>
		<p>Apps I love and use.</p>
	</div>
	<div
		class="mt-16 flex flex-col gap-4 sm:grid sm:grid-cols-2 sm:gap-4 md:grid-cols-3 xl:grid-cols-4"
	>
		{
			allApps.map(({ data }) => (
				<div class="flex flex-row rounded-2xl bg-neutral-50 sm:aspect-square sm:flex-col sm:items-center">
					<div class="flex items-center justify-center px-4 sm:w-full sm:grow sm:items-end lg:pb-4">
						<img
							src={data.icon.src}
							alt={data.icon.alt}
							class="aspect-square max-w-[72px] sm:max-w-[144px]"
						/>
					</div>
					<div class="flex h-fit flex-col gap-1 py-8 sm:items-center">
						<h2 class="font-medium">{data.name}</h2>
						<a
							href={data.url}
							target="_blank"
							class="text-sm font-medium text-blue-600"
						>
							{data.displayUrl}
						</a>
					</div>
				</div>
			))
		}
	</div>
</Layout>
